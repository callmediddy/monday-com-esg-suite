{"ast":null,"code":"import _toConsumableArray from\"/Users/akhand/Developer/monday/ratings/quickstart-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/akhand/Developer/monday/ratings/quickstart-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import\"./App.css\";import mondaySdk from\"monday-sdk-js\";import\"monday-ui-react-core/dist/main.css\";import Favorite from\"monday-ui-react-core/dist/icons/Favorite\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var monday=mondaySdk();var OLD_TOKEN='eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjE3NjYwMTI4NCwidWlkIjozMzQ2MDkzNCwiaWFkIjoiMjAyMi0wOC0yMVQwMDoxMDo0Ni4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6MTMxNTgyMzEsInJnbiI6InVzZTEifQ.LUmDgx0ng9YKgiqKtv0Em6p1mZ0mZNMFAOpOnvjwecQ';var NEW_TOKEN='eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjE3OTU2MzY2MCwidWlkIjozNDA3NjA0MCwiaWFkIjoiMjAyMi0wOS0wN1QwODoyMjoyMS4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6MTMzNDMxMjQsInJnbiI6InVzZTEifQ.OSWJsGaVs4Wf1C9YLAIvscYhBAL33Kf3R1w3CuUDJ-I';var App=function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),mainBoardID=_useState2[0],setMainBoardID=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),mainBoardItems=_useState4[0],setMainBoardItems=_useState4[1];var _useState5=useState(5),_useState6=_slicedToArray(_useState5,2),score=_useState6[0],setScore=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),antiScore=_useState8[0],setAntiScore=_useState8[1];function fetchMainBoard(){if(mainBoardID){var query=\"query {boards (ids:\".concat(mainBoardID,\"){items { column_values (ids:[\\\"rating\\\"]) {\\n        id text \\n      }}}} \");fetch(\"https://api.monday.com/v2\",{method:'post',headers:{'Content-Type':'application/json','Authorization':NEW_TOKEN},body:JSON.stringify({'query':query})}).then(function(res){return res.json();}).then(function(res){setMainBoardItems(res.data.boards[0].items);});}}function fetchContextBoard(){monday.listen(\"context\",function(res){console.log(\"Inside the use effect Context object changed: \",res.data.boardIds[0]);if(res.data.boardIds[0]!==undefined){setMainBoardID(res.data.boardIds[0]);console.log(\"Board ID fetched\");}});}function calculateRating(){var totalScore=0;if(mainBoardItems.length>0){console.log(\"Main board items are\");mainBoardItems.forEach(function(element){totalScore+=parseFloat(element.column_values[0].text);});var averageScore=totalScore/mainBoardItems.length;var roundedScore=Math.round(averageScore);setScore(roundedScore);setAntiScore(5-roundedScore);}console.log(score);console.log(antiScore);}useEffect(function(){fetchContextBoard();},[]);useEffect(function(){fetchMainBoard();},[mainBoardID]);useEffect(function(){calculateRating();},[mainBoardItems]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[_toConsumableArray(Array(score)).map(function(e,i){return/*#__PURE__*/_jsx(\"div\",{style:{color:\"var(--color-egg_yolk)\"},children:/*#__PURE__*/_jsx(Favorite,{size:\"huge\"})});}),_toConsumableArray(Array(antiScore)).map(function(e,i){return/*#__PURE__*/_jsx(\"div\",{style:{color:\"var(--color-american_gray)\"},children:/*#__PURE__*/_jsx(Favorite,{size:\"huge\"})});})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","mondaySdk","Favorite","monday","OLD_TOKEN","NEW_TOKEN","App","mainBoardID","setMainBoardID","mainBoardItems","setMainBoardItems","score","setScore","antiScore","setAntiScore","fetchMainBoard","query","fetch","method","headers","body","JSON","stringify","then","res","json","data","boards","items","fetchContextBoard","listen","console","log","boardIds","undefined","calculateRating","totalScore","length","forEach","element","parseFloat","column_values","text","averageScore","roundedScore","Math","round","Array","map","e","i","color"],"sources":["/Users/akhand/Developer/monday/ratings/quickstart-react/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport mondaySdk from \"monday-sdk-js\";\nimport \"monday-ui-react-core/dist/main.css\"\nimport Favorite from \"monday-ui-react-core/dist/icons/Favorite\"\n\nconst monday = mondaySdk();\n\nconst OLD_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjE3NjYwMTI4NCwidWlkIjozMzQ2MDkzNCwiaWFkIjoiMjAyMi0wOC0yMVQwMDoxMDo0Ni4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6MTMxNTgyMzEsInJnbiI6InVzZTEifQ.LUmDgx0ng9YKgiqKtv0Em6p1mZ0mZNMFAOpOnvjwecQ'\nconst NEW_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJ0aWQiOjE3OTU2MzY2MCwidWlkIjozNDA3NjA0MCwiaWFkIjoiMjAyMi0wOS0wN1QwODoyMjoyMS4wMDBaIiwicGVyIjoibWU6d3JpdGUiLCJhY3RpZCI6MTMzNDMxMjQsInJnbiI6InVzZTEifQ.OSWJsGaVs4Wf1C9YLAIvscYhBAL33Kf3R1w3CuUDJ-I'\n\nconst App = () => {\n\n\n  const [mainBoardID, setMainBoardID] = useState(null)\n  const [mainBoardItems, setMainBoardItems] = useState([])\n  const [score, setScore] = useState(5)\n  const [antiScore, setAntiScore] = useState(0)\n\n  function fetchMainBoard() {\n    if (mainBoardID) {\n      let query = `query {boards (ids:${mainBoardID}){items { column_values (ids:[\"rating\"]) {\n        id text \n      }}}} `;\n\n      fetch(\"https://api.monday.com/v2\", {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': NEW_TOKEN\n        },\n        body: JSON.stringify({\n          'query': query\n        })\n      })\n        .then(res => res.json())\n        .then(res => {\n          setMainBoardItems(res.data.boards[0].items)\n        });\n    }\n  }\n\n  function fetchContextBoard() {\n    monday.listen(\"context\", res => {\n      console.log(\"Inside the use effect Context object changed: \", res.data.boardIds[0]);\n      if (res.data.boardIds[0] !== undefined) {\n        setMainBoardID(res.data.boardIds[0])\n        console.log(\"Board ID fetched\")\n      }\n    })\n  }\n\n  function calculateRating() {\n    let totalScore = 0\n    if (mainBoardItems.length > 0) {\n      console.log(\"Main board items are\")\n      mainBoardItems.forEach(element => {\n        totalScore += parseFloat(element.column_values[0].text)\n      });\n      let averageScore = totalScore / mainBoardItems.length\n      let roundedScore = Math.round(averageScore)\n      setScore(roundedScore)\n      setAntiScore(5 - roundedScore)\n    }\n    console.log(score)\n    console.log(antiScore)\n  }\n\n  useEffect(() => {\n    fetchContextBoard()\n  }, [])\n\n\n  useEffect(() => {\n    fetchMainBoard()\n  }, [mainBoardID])\n\n  useEffect(() => {\n    calculateRating()\n  }, [mainBoardItems])\n\n\n  return (\n    <div className=\"App\">\n      {[...Array(score)].map((e, i) => <div style={{ color: \"var(--color-egg_yolk)\" }}><Favorite size=\"huge\" /></div>)}\n      {[...Array(antiScore)].map((e, i) => <div style={{ color: \"var(--color-american_gray)\" }}><Favorite size=\"huge\" /></div>)}\n    </div>\n  )\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}